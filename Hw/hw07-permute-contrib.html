
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Homework 7: Permute - contributing to an open source project &#8212; Collaborative and Reproducible Data Science</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Collaborative and Reproducible Data Science</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Statistics 159/259, Spring 2021 Course Summary
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Overview
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../schedule.html">
   Statistics 159/259: Weekly Plan
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Syllabus
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus for Statistics 159/259: Reproducible and Collaborative Statistical Data Science
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Homework Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="hw01-background.html">
   1. Homework 1. Stats review and intro to Git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw02-election-fraud.html">
   2. Homework 2. Election Fraud
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw03-testing.html">
   3. Homework 3: Coding style, docstrings, algorithmic choices, and unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw04-phil-sci-covid.html">
   4. Homework 4: Reproducibility, Philosophy of Science, and COVID-19 Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw05-selection-outliers.html">
   5. Homework 5: Selective inference and outlier rejection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw06-cryptorandom-contrib.html">
   6. Homework 6: Cryptorandom - contributing to an open source project
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Lecture Notes
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Notes/index.html">
   An Idiosyncratic Sample of Applied Statistics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Lecture Index
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Index/index.html">
   Index of Lectures and Materials
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Hw/hw07-permute-contrib.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#points-1-sided-bounds">
   [15 points] 1-sided bounds
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#points-2-sided-bounds">
   [30 points] 2-sided bounds.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grading">
   Grading
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#workflow">
   Workflow
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="homework-7-permute-contributing-to-an-open-source-project">
<h1>Homework 7: Permute - contributing to an open source project<a class="headerlink" href="#homework-7-permute-contributing-to-an-open-source-project" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><strong>Statistics 159/259, Spring 2021</strong></p></li>
<li><p><strong>Due 4/25/2021, 11:59PM PT</strong></p></li>
<li><p>Profs. Pérez and Stark, Department of Statistics, UC Berkeley.</p></li>
<li><p>This assignment is worth a maximum of <strong>40 points</strong>.</p></li>
<li><p>Assignment type: <strong>group</strong>.</p></li>
</ul>
<p>The purpose of this assignment is for your team to collaborate on the development of new contributions to another real-world open source repository, the <a class="reference external" href="https://github.com/statlab/permute"><code class="docutils literal notranslate"><span class="pre">permute</span></code></a> project we’ve discussed in class.  The high-level goal of the assignment is to make contributions to <code class="docutils literal notranslate"><span class="pre">permute</span></code> in three areas: <strong>functionality</strong>, <strong>tests</strong> of that functionality, and <strong>documentation</strong> of that functionality.  All of the changes will be to the <a class="reference external" href="https://github.com/statlab/permute/blob/main/permute/utils.py"><code class="docutils literal notranslate"><span class="pre">utils.py</span></code></a> file.</p>
<p>The assignment involves improving and extending two existing functions: <code class="docutils literal notranslate"><span class="pre">binom_conf_interval</span></code> and <code class="docutils literal notranslate"><span class="pre">hypergeom_conf_interval</span></code>. Those functions compute 1-sided and 2-sided confidence intervals for the binomial parameter <span class="math notranslate nohighlight">\(p\)</span> (<span class="math notranslate nohighlight">\(n\)</span> known) and for the hypergeometric parameter <span class="math notranslate nohighlight">\(G\)</span> (<span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(n\)</span> known). The current implementations are variants of the “Clopper-Pearson” approach (see <a class="reference external" href="https://www.jstor.org/stable/2676784?seq=1">Brown, Cai, and DasGupta (2001)</a>).</p>
<p>You will improve the two-sided intervals by adding a different method for the binomial and two different methods for the hypergeometric. The notes on <a class="reference internal" href="../Notes/tests.html"><span class="doc std std-doc">hypothesis tests</span></a> and <a class="reference internal" href="../Notes/confidence-sets.html"><span class="doc std std-doc">confidence sets</span></a> and code in those notes will probably be helpful.</p>
<p>Here are the goals of the assignment. They apply both to <code class="docutils literal notranslate"><span class="pre">binom_conf_interval</span></code> and to <code class="docutils literal notranslate"><span class="pre">hypergeom_conf_interval</span></code>.</p>
<div class="section" id="points-1-sided-bounds">
<h2>[15 points] 1-sided bounds<a class="headerlink" href="#points-1-sided-bounds" title="Permalink to this headline">¶</a></h2>
<p>For both <code class="docutils literal notranslate"><span class="pre">binom_conf_interval</span></code> and <code class="docutils literal notranslate"><span class="pre">hypergeom_conf_interval</span></code>, test the 1-sided confidence bounds that are already implemented. Report on the following and provide code, tests and documentation as appropriate:</p>
<ol class="simple">
<li><p><em>[5 points]</em> Check whether they correctly implement the mathematics. Correct them if not.</p></li>
<li><p><em>[5 points]</em> Check the endpoints are found in a numerically stable and efficient manner. Provide a better method if not.</p></li>
<li><p><em>[5 points]</em> Add unit tests that exercise all the options.</p></li>
</ol>
</div>
<div class="section" id="points-2-sided-bounds">
<h2>[30 points] 2-sided bounds.<a class="headerlink" href="#points-2-sided-bounds" title="Permalink to this headline">¶</a></h2>
<p>For both <code class="docutils literal notranslate"><span class="pre">binom_conf_interval</span></code> and <code class="docutils literal notranslate"><span class="pre">hypergeom_conf_interval</span></code>, test the 2-sided confidence bounds that are already implemented. Report on the following and provide code, tests and documentation as appropriate. (The <span class="math notranslate nohighlight">\(1-\alpha\)</span> Clopper-Pearson two-sided confidence bounds are the intersection of a 1-sided upper <span class="math notranslate nohighlight">\(1-\alpha/2\)</span> confidence interval and a 1-sided lower <span class="math notranslate nohighlight">\(1-\alpha/2\)</span> confidence interval.)</p>
<ol class="simple">
<li><p><em>[5 points]</em> Check whether the functions correctly implement the mathematics. Correct them if not.</p></li>
<li><p><em>[5 points]</em> Add unit tests that exercise all the options.</p></li>
<li><p><em>[10 points]</em> For both <code class="docutils literal notranslate"><span class="pre">binom_conf_interval</span></code> and <code class="docutils literal notranslate"><span class="pre">hypergeom_conf_interval</span></code>, extend the signature to include a <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter. The default value of <code class="docutils literal notranslate"><span class="pre">method</span></code> should be “<code class="docutils literal notranslate"><span class="pre">clopper-pearson</span></code>”. The <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter should not affect how 1-sided confidence bounds are calculated.</p>
<ol class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">method=&quot;clopper-pearson&quot;</span></code>, the 2-sided intervals should be calculated as the intersection of the 1-sided intervals using confidence level <span class="math notranslate nohighlight">\(1-\alpha/2\)</span>, based on the current implementation of the 1-sided bounds (or on your modification of the current implementation, if you improve them). This amounts to inverting 2-sided, significance level <span class="math notranslate nohighlight">\(\alpha\)</span> hypothesis tests where the chance that the observation will be larger than the largest value in the acceptance region is not greater than <span class="math notranslate nohighlight">\(\alpha/2\)</span> and the chance that the observation will be smaller than the smallest value in the acceptance region is not greater than <span class="math notranslate nohighlight">\(\alpha/2\)</span>. That is, it balances the probability of the tails.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">method=&quot;sterne&quot;</span></code>, the 2-sided intervals should be calculated by inverting tests that have the <em>smallest</em> acceptance regions, following the approaches in the notes. See <a class="reference external" href="https://www.jstor.org/stable/2333026">Sterne (1954)</a>. Rather than balance the probability of the tails, this approach minimizes the number of outcomes in the acceptance region, which tends to produce shorter confidence intervals. To implement this method, consider writing helper functions that calculate the acceptance regions. That will make it easier to debug and test your work. <strong>Note that there might be a bug in the implementation of 2-sided confidence bounds for binomial <span class="math notranslate nohighlight">\(p\)</span> in the notes. Be sure you are implementing the right thing!</strong></p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">method=&quot;wang&quot;</span></code>, the 2-sided intervals should be calculated using the “exact optimal” method of <a class="reference external" href="http://dx.doi.org/10.1080/01621459.2014.966191">Wang (2015)</a>. (Note that the <a class="reference external" href="https://www.tandfonline.com/doi/suppl/10.1080/01621459.2014.966191">supplementary materials</a> contain R code that purports to implement the method. We do not vouch for that code, but you might start by translating it into python.)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">method</span></code> takes any value other than “clopper-pearson”, “sterne”, or “wang”, the code should raise an exception.</p></li>
<li><p>Provide unit tests for the new functionality and any helper functions.</p></li>
<li><p>Provide appropriate docstrings for the new functionality.</p></li>
<li><p>Follow PEP-8 and PEP-257.</p></li>
</ol>
</li>
<li><p><em>[10 points]</em> Calculate (not simulate) the expected width of the 2-sided 95% confidence intervals for <code class="docutils literal notranslate"><span class="pre">method=&quot;clopper-pearson&quot;</span></code> , <code class="docutils literal notranslate"><span class="pre">method=&quot;sterne&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">method=&quot;wang&quot;</span></code> for a range of values of
<span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span> (for the binomial using Clopper-Pearson and Sterne) and for <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(G\)</span>, and <span class="math notranslate nohighlight">\(n\)</span> (for the hypergeometric using Clopper-Pearson, Sterne, and Wang).</p>
<ol class="simple">
<li><p>This should be turned in separately as a Jupyter notebook (called <code class="docutils literal notranslate"><span class="pre">confidence-intervals.ipynb</span></code>).</p></li>
<li><p>See the top of the left column of p.111 of <a class="reference external" href="https://www.jstor.org/stable/2676784?seq=1">Brown, Cai, and DasGupta (2001)</a> for a hint of how to calculate the expected length of binomial confidence intervals. The expression for hypergeometric is analogous, but should use the hypergeometric pmf rather than the binomial pmf.</p></li>
<li><p>Discuss the differences among the three methods. You might consider how long it takes the methods to run and the expected lengths of the intervals as the parameters vary.</p></li>
<li><p>Which would you recommend, and why? If you would recommend one method over the other in some circumstances but not in others, explain why.</p></li>
</ol>
</li>
</ol>
</div>
<div class="section" id="grading">
<h2>Grading<a class="headerlink" href="#grading" title="Permalink to this headline">¶</a></h2>
<p>The entire assignment is worth 40 points, broken down as follows:</p>
<ul class="simple">
<li><p>15 points: work on 1-sided confidence bounds.</p></li>
<li><p>30 points: work on 2-sided confidence bounds.  Note that this includes as a deliverable, a standalone Jupyter notebook that you should add at the top of your team’s repository, called <code class="docutils literal notranslate"><span class="pre">confidence-intervals.ipynb</span></code>.</p></li>
<li><p>5 points: summary release notes that highlight your changes to the various functions, called <code class="docutils literal notranslate"><span class="pre">hw07-summary.md</span></code>, along with a PDF render of the same.</p></li>
</ul>
<p>As in the previous assignment, we will look at the workflow of opening issues and evolving your code as PRs on your repo.</p>
</div>
<div class="section" id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<p>You will be assigned to a small team of <strong>2</strong> students. We suggest that you use this as an opportunity to try out pair programming (here <a class="reference external" href="https://martinfowler.com/articles/on-pair-programming.html">some</a> <a class="reference external" href="https://medium.com/&#64;weblab_tech/pair-programming-guide-a76ca43ff389">resources</a> you might find useful on this topic).</p>
<p>In this case, we will <em>not</em> set up separate team Slack channels - you can talk to your partner via DM, and the two of you can ping <code class="docutils literal notranslate"><span class="pre">&#64;instructors</span></code> if you need us for a private question, or ask on the <code class="docutils literal notranslate"><span class="pre">#homework</span></code> channel as usueal for anything that’s not private (and we highly encourage public questions, as the answers may help everyone else as well).</p>
<p>Otherwise you should still work “in public” as before: Keep the team repo the system creates as your <code class="docutils literal notranslate"><span class="pre">upstream</span></code> and each of you make a personal fork that is your <code class="docutils literal notranslate"><span class="pre">origin</span></code>. Use Github issues as a “bulletin board” for each PR you will create, and do a proper code review of the PR on GitHub.   If you wrote the code together while pair programming you can note that fact in the PR review and keep it short, but you should still have a PR and some evidence of a public check on the work. This is part of the work of building public trust on an open source tool by communicating not only with one another, but also by leaving a public record for the rest of the community.</p>
<p>In general, all other guidelines regarding testing, documentation, PRs, GitHub Actions and more, from the HW06 group assignment, apply equally here, so we won’t repeat them. You can refresh your memory by <a class="reference external" href="hw06-cryptorandom-contrib.md#Tips-for-this-assignment">checking out those notes</a> as they apply equally to this one (obviously substituting the paths and names for the <code class="docutils literal notranslate"><span class="pre">permute</span></code> repo and project instead of <code class="docutils literal notranslate"><span class="pre">cryptorandom</span></code> as appropriate).</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Hw"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Philip Stark and Fernando Pérez<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>